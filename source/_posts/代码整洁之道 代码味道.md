---
title: 代码整洁之道 代码习惯
date: 2020-10-19 15:36:00
tags:
    - 代码整洁之道
    - clean code
    - 阅读笔记
description: 代码整洁之道代码味道列表
---

# 味道与启发(bad smell)

## 注释
1. 不恰当的信息
2. 废弃的注释
3. 冗余注释
    - 描述解释的是某种充分自我描述的东西，那么注释就是多余的
4. 糟糕的注释
5. 注释掉的代码

## 环境
1. 需要多步才能实现的构建
    - 构建系统应该是单步的小操作，但不应该依赖一系列指令或环境依赖脚本，不应该到处寻找额外的jar、xml等。应该能够用单个命令构建，单个命令运行。
2. 需要多步才能做到的测试

## 函数
1. 过多的参数
2. 输出参数
    - 输出参数违反直觉
3. 标识函数
    - 通过布尔值在函数中做多个功能
4. 死函数(永远不会被调用的函数)

## 一般性问题
1. 一个源文件中存在多种语言
    - 比如java中还包括XML、HTML、YAML等
2. 明显的行为未被实现
    - 比如将日期翻译成该日期的枚举累，我们希望Monday可以翻译，也希望缩写可以翻译，同时还希望忽略大小写。如果以上的功能没能实现，用户就需要阅读代码细节而不是依靠对函数名的直觉。
3. 不正确的边界行为
4. 忽视安全
5. 重复
    - DRY原则(Don't Repeat Yourself，别重复自己)
6. 在错误的抽象层级上的代码
    - 至于细节实现有关的常量、变量或工具函数不应在积累中出现
    - 对源文件、组件和模块也适用，不同层级对概念应该分离到不同的容器中
7. 基类依赖与派生类
    - 基类概念不应该依赖叫底层派生类的概念
8. 信息过多
9. 死代码(不执行的代码)
10. 垂直分隔
    - 变量和函数应该在靠近被使用的地方定义
11. 前后不一致
12. 混淆视听
    - 没有用的变量
    - 从不调用的函数
    - 没有用的注释
    - 等等其他应该移除的
13. 人为耦合
    - 两个没有直接目的之间模块的耦合耦。根源是将变量、常量或函数不恰当地放在临时方便地位置位置。
14. 特性依赖
    - 类的方法应该只对其所属类的变量和函数感兴趣感兴趣。
15. 选择算子参数
    - 函数中的标识位(布尔、枚举、整数等等)
16. 晦涩的意图
    - 代码应该尽可能具有表达力
17. 位置错误的权责
    - 在哪里放置代码
18. 不恰当的静态方法
    - 通常应倾向于选用非静态方法
19. 使用解释性变量
    - 让程序刻度的最有力的方式之一就是将计算过程打散成在用有意义的单词命名的变量中放置的中间值
20. 函数名称应该表达其行为
21. 理解算法
22. 把逻辑依赖改为物理依赖
23. 用多态替代If/Else或Switch/Case
24. 遵循标准约定
    - 遵循团队中的标准
25. 用明明常量替代魔术数
26. 准确
    - 第一次匹配不等于唯一匹配
    - 浮点数不能直接用在货币计算上
    - 某些行为应该使用事务
    - 等等等等，应该在恰当的位置使用准确的方式
27. 结构甚于约定
    - 坚守结构甚于约定甚于约定的设计决策
28. 封装条件
    - 应该把解释了条件意图的函数抽离出来
29. 避免否定性条件
30. 函数只该做一件事
31. 掩蔽时序耦合
    - 每个函数都穿出下一个函数所需的结果，这样一来就没理由不按顺序调用了
32. 别随意
    - 代码的组织和构建是需要有理由的，不要随意堆砌
33. 封装边界条件
    - 边界条件难以追踪。把边界条件的代码集中到一处，不要散落在代码中。
34. 函数应该只在一个抽象层级上
    - 函数中的语句应该在同一抽象层级上，该层级应该是函数名所示操作的下一层。
35. 在较高层级放置可配置数据
36. 避免传递浏览
    - 模块只了解其直接协作者，不了解整个系统的游览图

## JAVA
1. 通过使用通配符避免过长的导入清单(印象中和阿里的编程原则有冲突)
    - import package.*
2. 不要继承常量
    - 在某个接口中放置了常量，在他的继承类中使用。在更深的继承层级中会很困惑这些常量的来源。
3. 常量vs枚举

## 名称
1. 采用描述性名称
2. 名称应与抽象层级相符
3. 尽可能使用标准命名法
    - 比如如果采用装饰器模式，就该以Decorator结尾
4. 无歧义的名称
5. 为较大作用范围选用较长的名称
    - for循环中for(i)，如果循环体中逻辑复杂，应该选用有意义的命名
6. 避免编码
    - 不应在名称中包括类型或作用范围信息
7. 名称应说明副作用

## 测试
1. 测试不足
2. 使用覆盖率工具
3. 别略过小测试
4. 被忽略的测试就是对不确定事务的疑问
5. 测试边界条件
6. 全面测试相近的缺陷
    - 缺陷趋向于扎堆，在某个函数中发现一个缺陷时，最好全面测试那个函数
7. 测试应该快速